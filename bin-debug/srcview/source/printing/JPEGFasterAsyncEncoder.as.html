<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>JPEGFasterAsyncEncoder.as</title>
<link rel="stylesheet" type="text/css" href="../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">printing</span>
<span class="ActionScriptBracket/Brace">{</span>
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BitmapData</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EventDispatcher</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ProgressEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ByteArray</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setTimeout</span>;
    
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">JPEGAsyncCompleteEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">JPEGASYNC_COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"com.pfp.events.JPEGAsyncCompleteEvent"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PROGRESS</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"flash.events.ProgressEvent"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">final</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">JPEGFasterAsyncEncoder</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">EventDispatcher</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">CONTENT_TYPE</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"image/jpeg"</span>;
        
        <span class="ActionScriptComment">// Static table initialization
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">ZigZag</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>
            0<span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> 5<span class="ActionScriptOperator">,</span> 6<span class="ActionScriptOperator">,</span>14<span class="ActionScriptOperator">,</span>15<span class="ActionScriptOperator">,</span>27<span class="ActionScriptOperator">,</span>28<span class="ActionScriptOperator">,</span>
            2<span class="ActionScriptOperator">,</span> 4<span class="ActionScriptOperator">,</span> 7<span class="ActionScriptOperator">,</span>13<span class="ActionScriptOperator">,</span>16<span class="ActionScriptOperator">,</span>26<span class="ActionScriptOperator">,</span>29<span class="ActionScriptOperator">,</span>42<span class="ActionScriptOperator">,</span>
            3<span class="ActionScriptOperator">,</span> 8<span class="ActionScriptOperator">,</span>12<span class="ActionScriptOperator">,</span>17<span class="ActionScriptOperator">,</span>25<span class="ActionScriptOperator">,</span>30<span class="ActionScriptOperator">,</span>41<span class="ActionScriptOperator">,</span>43<span class="ActionScriptOperator">,</span>
            9<span class="ActionScriptOperator">,</span>11<span class="ActionScriptOperator">,</span>18<span class="ActionScriptOperator">,</span>24<span class="ActionScriptOperator">,</span>31<span class="ActionScriptOperator">,</span>40<span class="ActionScriptOperator">,</span>44<span class="ActionScriptOperator">,</span>53<span class="ActionScriptOperator">,</span>
            10<span class="ActionScriptOperator">,</span>19<span class="ActionScriptOperator">,</span>23<span class="ActionScriptOperator">,</span>32<span class="ActionScriptOperator">,</span>39<span class="ActionScriptOperator">,</span>45<span class="ActionScriptOperator">,</span>52<span class="ActionScriptOperator">,</span>54<span class="ActionScriptOperator">,</span>
            20<span class="ActionScriptOperator">,</span>22<span class="ActionScriptOperator">,</span>33<span class="ActionScriptOperator">,</span>38<span class="ActionScriptOperator">,</span>46<span class="ActionScriptOperator">,</span>51<span class="ActionScriptOperator">,</span>55<span class="ActionScriptOperator">,</span>60<span class="ActionScriptOperator">,</span>
            21<span class="ActionScriptOperator">,</span>34<span class="ActionScriptOperator">,</span>37<span class="ActionScriptOperator">,</span>47<span class="ActionScriptOperator">,</span>50<span class="ActionScriptOperator">,</span>56<span class="ActionScriptOperator">,</span>59<span class="ActionScriptOperator">,</span>61<span class="ActionScriptOperator">,</span>
            35<span class="ActionScriptOperator">,</span>36<span class="ActionScriptOperator">,</span>48<span class="ActionScriptOperator">,</span>49<span class="ActionScriptOperator">,</span>57<span class="ActionScriptOperator">,</span>58<span class="ActionScriptOperator">,</span>62<span class="ActionScriptOperator">,</span>63
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">YTable</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">UVTable</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">outputfDCTQuant</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fdtbl_Y</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fdtbl_UV</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sf</span>:<span class="ActionScriptDefault_Text">int</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">aasf</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>
            1.0<span class="ActionScriptOperator">,</span> 1.387039845<span class="ActionScriptOperator">,</span> 1.306562965<span class="ActionScriptOperator">,</span> 1.175875602<span class="ActionScriptOperator">,</span>
            1.0<span class="ActionScriptOperator">,</span> 0.785694958<span class="ActionScriptOperator">,</span> 0.541196100<span class="ActionScriptOperator">,</span> 0.275899379
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">YQT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>
            16<span class="ActionScriptOperator">,</span> 11<span class="ActionScriptOperator">,</span> 10<span class="ActionScriptOperator">,</span> 16<span class="ActionScriptOperator">,</span> 24<span class="ActionScriptOperator">,</span> 40<span class="ActionScriptOperator">,</span> 51<span class="ActionScriptOperator">,</span> 61<span class="ActionScriptOperator">,</span>
            12<span class="ActionScriptOperator">,</span> 12<span class="ActionScriptOperator">,</span> 14<span class="ActionScriptOperator">,</span> 19<span class="ActionScriptOperator">,</span> 26<span class="ActionScriptOperator">,</span> 58<span class="ActionScriptOperator">,</span> 60<span class="ActionScriptOperator">,</span> 55<span class="ActionScriptOperator">,</span>
            14<span class="ActionScriptOperator">,</span> 13<span class="ActionScriptOperator">,</span> 16<span class="ActionScriptOperator">,</span> 24<span class="ActionScriptOperator">,</span> 40<span class="ActionScriptOperator">,</span> 57<span class="ActionScriptOperator">,</span> 69<span class="ActionScriptOperator">,</span> 56<span class="ActionScriptOperator">,</span>
            14<span class="ActionScriptOperator">,</span> 17<span class="ActionScriptOperator">,</span> 22<span class="ActionScriptOperator">,</span> 29<span class="ActionScriptOperator">,</span> 51<span class="ActionScriptOperator">,</span> 87<span class="ActionScriptOperator">,</span> 80<span class="ActionScriptOperator">,</span> 62<span class="ActionScriptOperator">,</span>
            18<span class="ActionScriptOperator">,</span> 22<span class="ActionScriptOperator">,</span> 37<span class="ActionScriptOperator">,</span> 56<span class="ActionScriptOperator">,</span> 68<span class="ActionScriptOperator">,</span>109<span class="ActionScriptOperator">,</span>103<span class="ActionScriptOperator">,</span> 77<span class="ActionScriptOperator">,</span>
            24<span class="ActionScriptOperator">,</span> 35<span class="ActionScriptOperator">,</span> 55<span class="ActionScriptOperator">,</span> 64<span class="ActionScriptOperator">,</span> 81<span class="ActionScriptOperator">,</span>104<span class="ActionScriptOperator">,</span>113<span class="ActionScriptOperator">,</span> 92<span class="ActionScriptOperator">,</span>
            49<span class="ActionScriptOperator">,</span> 64<span class="ActionScriptOperator">,</span> 78<span class="ActionScriptOperator">,</span> 87<span class="ActionScriptOperator">,</span>103<span class="ActionScriptOperator">,</span>121<span class="ActionScriptOperator">,</span>120<span class="ActionScriptOperator">,</span>101<span class="ActionScriptOperator">,</span>
            72<span class="ActionScriptOperator">,</span> 92<span class="ActionScriptOperator">,</span> 95<span class="ActionScriptOperator">,</span> 98<span class="ActionScriptOperator">,</span>112<span class="ActionScriptOperator">,</span>100<span class="ActionScriptOperator">,</span>103<span class="ActionScriptOperator">,</span> 99
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">UVQT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>
            17<span class="ActionScriptOperator">,</span> 18<span class="ActionScriptOperator">,</span> 24<span class="ActionScriptOperator">,</span> 47<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span>
            18<span class="ActionScriptOperator">,</span> 21<span class="ActionScriptOperator">,</span> 26<span class="ActionScriptOperator">,</span> 66<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span>
            24<span class="ActionScriptOperator">,</span> 26<span class="ActionScriptOperator">,</span> 56<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span>
            47<span class="ActionScriptOperator">,</span> 66<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span>
            99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span>
            99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span>
            99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span>
            99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99<span class="ActionScriptOperator">,</span> 99
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initQuantTables</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sf</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I64</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 64;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I8</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 8;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">I64</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">YQT</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">sf</span><span class="ActionScriptOperator">+</span>50<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.01<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> 1;
                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">&gt;</span> 255<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> 255;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">YTable</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ZigZag</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">t</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">I64</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">u</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UVQT</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">sf</span><span class="ActionScriptOperator">+</span>50<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>0.01<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">u</span> <span class="ActionScriptOperator">&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">u</span> <span class="ActionScriptOperator">=</span> 1;
                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">u</span> <span class="ActionScriptOperator">&gt;</span> 255<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">u</span> <span class="ActionScriptOperator">=</span> 255;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">UVTable</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ZigZag</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">u</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">I8</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">col</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">col</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">I8</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">col</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">fdtbl_Y</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">YTable</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ZigZag</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">aasf</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">aasf</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">col</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">I8</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">fdtbl_UV</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UVTable</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ZigZag</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">aasf</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">aasf</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">col</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">I8</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">YDC_HT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">UVDC_HT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">YAC_HT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">UVAC_HT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">computeHuffmanTbl</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nrcodes</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">std_table</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">codevalue</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pos_in_table</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">HT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>251<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bitString</span>:<span class="ActionScriptDefault_Text">BitString</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>1; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">&lt;=</span>16; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>1; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">nrcodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">HT</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">std_table</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos_in_table</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bitString</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">bitString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">codevalue</span>;
                    <span class="ActionScriptDefault_Text">bitString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;
                    <span class="ActionScriptDefault_Text">pos_in_table</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptDefault_Text">codevalue</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">codevalue</span><span class="ActionScriptOperator">&lt;&lt;=</span>1;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">HT</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_dc_luminance_nrcodes</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>5<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_dc_luminance_values</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>5<span class="ActionScriptOperator">,</span>6<span class="ActionScriptOperator">,</span>7<span class="ActionScriptOperator">,</span>8<span class="ActionScriptOperator">,</span>9<span class="ActionScriptOperator">,</span>10<span class="ActionScriptOperator">,</span>11<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_ac_luminance_nrcodes</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span>5<span class="ActionScriptOperator">,</span>5<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>0x7d<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_ac_luminance_values</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0x01<span class="ActionScriptOperator">,</span>0x02<span class="ActionScriptOperator">,</span>0x03<span class="ActionScriptOperator">,</span>0x00<span class="ActionScriptOperator">,</span>0x04<span class="ActionScriptOperator">,</span>0x11<span class="ActionScriptOperator">,</span>0x05<span class="ActionScriptOperator">,</span>0x12<span class="ActionScriptOperator">,</span>
            0x21<span class="ActionScriptOperator">,</span>0x31<span class="ActionScriptOperator">,</span>0x41<span class="ActionScriptOperator">,</span>0x06<span class="ActionScriptOperator">,</span>0x13<span class="ActionScriptOperator">,</span>0x51<span class="ActionScriptOperator">,</span>0x61<span class="ActionScriptOperator">,</span>0x07<span class="ActionScriptOperator">,</span>
            0x22<span class="ActionScriptOperator">,</span>0x71<span class="ActionScriptOperator">,</span>0x14<span class="ActionScriptOperator">,</span>0x32<span class="ActionScriptOperator">,</span>0x81<span class="ActionScriptOperator">,</span>0x91<span class="ActionScriptOperator">,</span>0xa1<span class="ActionScriptOperator">,</span>0x08<span class="ActionScriptOperator">,</span>
            0x23<span class="ActionScriptOperator">,</span>0x42<span class="ActionScriptOperator">,</span>0xb1<span class="ActionScriptOperator">,</span>0xc1<span class="ActionScriptOperator">,</span>0x15<span class="ActionScriptOperator">,</span>0x52<span class="ActionScriptOperator">,</span>0xd1<span class="ActionScriptOperator">,</span>0xf0<span class="ActionScriptOperator">,</span>
            0x24<span class="ActionScriptOperator">,</span>0x33<span class="ActionScriptOperator">,</span>0x62<span class="ActionScriptOperator">,</span>0x72<span class="ActionScriptOperator">,</span>0x82<span class="ActionScriptOperator">,</span>0x09<span class="ActionScriptOperator">,</span>0x0a<span class="ActionScriptOperator">,</span>0x16<span class="ActionScriptOperator">,</span>
            0x17<span class="ActionScriptOperator">,</span>0x18<span class="ActionScriptOperator">,</span>0x19<span class="ActionScriptOperator">,</span>0x1a<span class="ActionScriptOperator">,</span>0x25<span class="ActionScriptOperator">,</span>0x26<span class="ActionScriptOperator">,</span>0x27<span class="ActionScriptOperator">,</span>0x28<span class="ActionScriptOperator">,</span>
            0x29<span class="ActionScriptOperator">,</span>0x2a<span class="ActionScriptOperator">,</span>0x34<span class="ActionScriptOperator">,</span>0x35<span class="ActionScriptOperator">,</span>0x36<span class="ActionScriptOperator">,</span>0x37<span class="ActionScriptOperator">,</span>0x38<span class="ActionScriptOperator">,</span>0x39<span class="ActionScriptOperator">,</span>
            0x3a<span class="ActionScriptOperator">,</span>0x43<span class="ActionScriptOperator">,</span>0x44<span class="ActionScriptOperator">,</span>0x45<span class="ActionScriptOperator">,</span>0x46<span class="ActionScriptOperator">,</span>0x47<span class="ActionScriptOperator">,</span>0x48<span class="ActionScriptOperator">,</span>0x49<span class="ActionScriptOperator">,</span>
            0x4a<span class="ActionScriptOperator">,</span>0x53<span class="ActionScriptOperator">,</span>0x54<span class="ActionScriptOperator">,</span>0x55<span class="ActionScriptOperator">,</span>0x56<span class="ActionScriptOperator">,</span>0x57<span class="ActionScriptOperator">,</span>0x58<span class="ActionScriptOperator">,</span>0x59<span class="ActionScriptOperator">,</span>
            0x5a<span class="ActionScriptOperator">,</span>0x63<span class="ActionScriptOperator">,</span>0x64<span class="ActionScriptOperator">,</span>0x65<span class="ActionScriptOperator">,</span>0x66<span class="ActionScriptOperator">,</span>0x67<span class="ActionScriptOperator">,</span>0x68<span class="ActionScriptOperator">,</span>0x69<span class="ActionScriptOperator">,</span>
            0x6a<span class="ActionScriptOperator">,</span>0x73<span class="ActionScriptOperator">,</span>0x74<span class="ActionScriptOperator">,</span>0x75<span class="ActionScriptOperator">,</span>0x76<span class="ActionScriptOperator">,</span>0x77<span class="ActionScriptOperator">,</span>0x78<span class="ActionScriptOperator">,</span>0x79<span class="ActionScriptOperator">,</span>
            0x7a<span class="ActionScriptOperator">,</span>0x83<span class="ActionScriptOperator">,</span>0x84<span class="ActionScriptOperator">,</span>0x85<span class="ActionScriptOperator">,</span>0x86<span class="ActionScriptOperator">,</span>0x87<span class="ActionScriptOperator">,</span>0x88<span class="ActionScriptOperator">,</span>0x89<span class="ActionScriptOperator">,</span>
            0x8a<span class="ActionScriptOperator">,</span>0x92<span class="ActionScriptOperator">,</span>0x93<span class="ActionScriptOperator">,</span>0x94<span class="ActionScriptOperator">,</span>0x95<span class="ActionScriptOperator">,</span>0x96<span class="ActionScriptOperator">,</span>0x97<span class="ActionScriptOperator">,</span>0x98<span class="ActionScriptOperator">,</span>
            0x99<span class="ActionScriptOperator">,</span>0x9a<span class="ActionScriptOperator">,</span>0xa2<span class="ActionScriptOperator">,</span>0xa3<span class="ActionScriptOperator">,</span>0xa4<span class="ActionScriptOperator">,</span>0xa5<span class="ActionScriptOperator">,</span>0xa6<span class="ActionScriptOperator">,</span>0xa7<span class="ActionScriptOperator">,</span>
            0xa8<span class="ActionScriptOperator">,</span>0xa9<span class="ActionScriptOperator">,</span>0xaa<span class="ActionScriptOperator">,</span>0xb2<span class="ActionScriptOperator">,</span>0xb3<span class="ActionScriptOperator">,</span>0xb4<span class="ActionScriptOperator">,</span>0xb5<span class="ActionScriptOperator">,</span>0xb6<span class="ActionScriptOperator">,</span>
            0xb7<span class="ActionScriptOperator">,</span>0xb8<span class="ActionScriptOperator">,</span>0xb9<span class="ActionScriptOperator">,</span>0xba<span class="ActionScriptOperator">,</span>0xc2<span class="ActionScriptOperator">,</span>0xc3<span class="ActionScriptOperator">,</span>0xc4<span class="ActionScriptOperator">,</span>0xc5<span class="ActionScriptOperator">,</span>
            0xc6<span class="ActionScriptOperator">,</span>0xc7<span class="ActionScriptOperator">,</span>0xc8<span class="ActionScriptOperator">,</span>0xc9<span class="ActionScriptOperator">,</span>0xca<span class="ActionScriptOperator">,</span>0xd2<span class="ActionScriptOperator">,</span>0xd3<span class="ActionScriptOperator">,</span>0xd4<span class="ActionScriptOperator">,</span>
            0xd5<span class="ActionScriptOperator">,</span>0xd6<span class="ActionScriptOperator">,</span>0xd7<span class="ActionScriptOperator">,</span>0xd8<span class="ActionScriptOperator">,</span>0xd9<span class="ActionScriptOperator">,</span>0xda<span class="ActionScriptOperator">,</span>0xe1<span class="ActionScriptOperator">,</span>0xe2<span class="ActionScriptOperator">,</span>
            0xe3<span class="ActionScriptOperator">,</span>0xe4<span class="ActionScriptOperator">,</span>0xe5<span class="ActionScriptOperator">,</span>0xe6<span class="ActionScriptOperator">,</span>0xe7<span class="ActionScriptOperator">,</span>0xe8<span class="ActionScriptOperator">,</span>0xe9<span class="ActionScriptOperator">,</span>0xea<span class="ActionScriptOperator">,</span>
            0xf1<span class="ActionScriptOperator">,</span>0xf2<span class="ActionScriptOperator">,</span>0xf3<span class="ActionScriptOperator">,</span>0xf4<span class="ActionScriptOperator">,</span>0xf5<span class="ActionScriptOperator">,</span>0xf6<span class="ActionScriptOperator">,</span>0xf7<span class="ActionScriptOperator">,</span>0xf8<span class="ActionScriptOperator">,</span>
            0xf9<span class="ActionScriptOperator">,</span>0xfa<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_dc_chrominance_nrcodes</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_dc_chrominance_values</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>5<span class="ActionScriptOperator">,</span>6<span class="ActionScriptOperator">,</span>7<span class="ActionScriptOperator">,</span>8<span class="ActionScriptOperator">,</span>9<span class="ActionScriptOperator">,</span>10<span class="ActionScriptOperator">,</span>11<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_ac_chrominance_nrcodes</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>7<span class="ActionScriptOperator">,</span>5<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>4<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span>0x77<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">std_ac_chrominance_values</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span>0x00<span class="ActionScriptOperator">,</span>0x01<span class="ActionScriptOperator">,</span>0x02<span class="ActionScriptOperator">,</span>0x03<span class="ActionScriptOperator">,</span>0x11<span class="ActionScriptOperator">,</span>0x04<span class="ActionScriptOperator">,</span>0x05<span class="ActionScriptOperator">,</span>0x21<span class="ActionScriptOperator">,</span>
            0x31<span class="ActionScriptOperator">,</span>0x06<span class="ActionScriptOperator">,</span>0x12<span class="ActionScriptOperator">,</span>0x41<span class="ActionScriptOperator">,</span>0x51<span class="ActionScriptOperator">,</span>0x07<span class="ActionScriptOperator">,</span>0x61<span class="ActionScriptOperator">,</span>0x71<span class="ActionScriptOperator">,</span>
            0x13<span class="ActionScriptOperator">,</span>0x22<span class="ActionScriptOperator">,</span>0x32<span class="ActionScriptOperator">,</span>0x81<span class="ActionScriptOperator">,</span>0x08<span class="ActionScriptOperator">,</span>0x14<span class="ActionScriptOperator">,</span>0x42<span class="ActionScriptOperator">,</span>0x91<span class="ActionScriptOperator">,</span>
            0xa1<span class="ActionScriptOperator">,</span>0xb1<span class="ActionScriptOperator">,</span>0xc1<span class="ActionScriptOperator">,</span>0x09<span class="ActionScriptOperator">,</span>0x23<span class="ActionScriptOperator">,</span>0x33<span class="ActionScriptOperator">,</span>0x52<span class="ActionScriptOperator">,</span>0xf0<span class="ActionScriptOperator">,</span>
            0x15<span class="ActionScriptOperator">,</span>0x62<span class="ActionScriptOperator">,</span>0x72<span class="ActionScriptOperator">,</span>0xd1<span class="ActionScriptOperator">,</span>0x0a<span class="ActionScriptOperator">,</span>0x16<span class="ActionScriptOperator">,</span>0x24<span class="ActionScriptOperator">,</span>0x34<span class="ActionScriptOperator">,</span>
            0xe1<span class="ActionScriptOperator">,</span>0x25<span class="ActionScriptOperator">,</span>0xf1<span class="ActionScriptOperator">,</span>0x17<span class="ActionScriptOperator">,</span>0x18<span class="ActionScriptOperator">,</span>0x19<span class="ActionScriptOperator">,</span>0x1a<span class="ActionScriptOperator">,</span>0x26<span class="ActionScriptOperator">,</span>
            0x27<span class="ActionScriptOperator">,</span>0x28<span class="ActionScriptOperator">,</span>0x29<span class="ActionScriptOperator">,</span>0x2a<span class="ActionScriptOperator">,</span>0x35<span class="ActionScriptOperator">,</span>0x36<span class="ActionScriptOperator">,</span>0x37<span class="ActionScriptOperator">,</span>0x38<span class="ActionScriptOperator">,</span>
            0x39<span class="ActionScriptOperator">,</span>0x3a<span class="ActionScriptOperator">,</span>0x43<span class="ActionScriptOperator">,</span>0x44<span class="ActionScriptOperator">,</span>0x45<span class="ActionScriptOperator">,</span>0x46<span class="ActionScriptOperator">,</span>0x47<span class="ActionScriptOperator">,</span>0x48<span class="ActionScriptOperator">,</span>
            0x49<span class="ActionScriptOperator">,</span>0x4a<span class="ActionScriptOperator">,</span>0x53<span class="ActionScriptOperator">,</span>0x54<span class="ActionScriptOperator">,</span>0x55<span class="ActionScriptOperator">,</span>0x56<span class="ActionScriptOperator">,</span>0x57<span class="ActionScriptOperator">,</span>0x58<span class="ActionScriptOperator">,</span>
            0x59<span class="ActionScriptOperator">,</span>0x5a<span class="ActionScriptOperator">,</span>0x63<span class="ActionScriptOperator">,</span>0x64<span class="ActionScriptOperator">,</span>0x65<span class="ActionScriptOperator">,</span>0x66<span class="ActionScriptOperator">,</span>0x67<span class="ActionScriptOperator">,</span>0x68<span class="ActionScriptOperator">,</span>
            0x69<span class="ActionScriptOperator">,</span>0x6a<span class="ActionScriptOperator">,</span>0x73<span class="ActionScriptOperator">,</span>0x74<span class="ActionScriptOperator">,</span>0x75<span class="ActionScriptOperator">,</span>0x76<span class="ActionScriptOperator">,</span>0x77<span class="ActionScriptOperator">,</span>0x78<span class="ActionScriptOperator">,</span>
            0x79<span class="ActionScriptOperator">,</span>0x7a<span class="ActionScriptOperator">,</span>0x82<span class="ActionScriptOperator">,</span>0x83<span class="ActionScriptOperator">,</span>0x84<span class="ActionScriptOperator">,</span>0x85<span class="ActionScriptOperator">,</span>0x86<span class="ActionScriptOperator">,</span>0x87<span class="ActionScriptOperator">,</span>
            0x88<span class="ActionScriptOperator">,</span>0x89<span class="ActionScriptOperator">,</span>0x8a<span class="ActionScriptOperator">,</span>0x92<span class="ActionScriptOperator">,</span>0x93<span class="ActionScriptOperator">,</span>0x94<span class="ActionScriptOperator">,</span>0x95<span class="ActionScriptOperator">,</span>0x96<span class="ActionScriptOperator">,</span>
            0x97<span class="ActionScriptOperator">,</span>0x98<span class="ActionScriptOperator">,</span>0x99<span class="ActionScriptOperator">,</span>0x9a<span class="ActionScriptOperator">,</span>0xa2<span class="ActionScriptOperator">,</span>0xa3<span class="ActionScriptOperator">,</span>0xa4<span class="ActionScriptOperator">,</span>0xa5<span class="ActionScriptOperator">,</span>
            0xa6<span class="ActionScriptOperator">,</span>0xa7<span class="ActionScriptOperator">,</span>0xa8<span class="ActionScriptOperator">,</span>0xa9<span class="ActionScriptOperator">,</span>0xaa<span class="ActionScriptOperator">,</span>0xb2<span class="ActionScriptOperator">,</span>0xb3<span class="ActionScriptOperator">,</span>0xb4<span class="ActionScriptOperator">,</span>
            0xb5<span class="ActionScriptOperator">,</span>0xb6<span class="ActionScriptOperator">,</span>0xb7<span class="ActionScriptOperator">,</span>0xb8<span class="ActionScriptOperator">,</span>0xb9<span class="ActionScriptOperator">,</span>0xba<span class="ActionScriptOperator">,</span>0xc2<span class="ActionScriptOperator">,</span>0xc3<span class="ActionScriptOperator">,</span>
            0xc4<span class="ActionScriptOperator">,</span>0xc5<span class="ActionScriptOperator">,</span>0xc6<span class="ActionScriptOperator">,</span>0xc7<span class="ActionScriptOperator">,</span>0xc8<span class="ActionScriptOperator">,</span>0xc9<span class="ActionScriptOperator">,</span>0xca<span class="ActionScriptOperator">,</span>0xd2<span class="ActionScriptOperator">,</span>
            0xd3<span class="ActionScriptOperator">,</span>0xd4<span class="ActionScriptOperator">,</span>0xd5<span class="ActionScriptOperator">,</span>0xd6<span class="ActionScriptOperator">,</span>0xd7<span class="ActionScriptOperator">,</span>0xd8<span class="ActionScriptOperator">,</span>0xd9<span class="ActionScriptOperator">,</span>0xda<span class="ActionScriptOperator">,</span>
            0xe2<span class="ActionScriptOperator">,</span>0xe3<span class="ActionScriptOperator">,</span>0xe4<span class="ActionScriptOperator">,</span>0xe5<span class="ActionScriptOperator">,</span>0xe6<span class="ActionScriptOperator">,</span>0xe7<span class="ActionScriptOperator">,</span>0xe8<span class="ActionScriptOperator">,</span>0xe9<span class="ActionScriptOperator">,</span>
            0xea<span class="ActionScriptOperator">,</span>0xf2<span class="ActionScriptOperator">,</span>0xf3<span class="ActionScriptOperator">,</span>0xf4<span class="ActionScriptOperator">,</span>0xf5<span class="ActionScriptOperator">,</span>0xf6<span class="ActionScriptOperator">,</span>0xf7<span class="ActionScriptOperator">,</span>0xf8<span class="ActionScriptOperator">,</span>
            0xf9<span class="ActionScriptOperator">,</span>0xfa
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initHuffmanTbl</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">YDC_HT</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">computeHuffmanTbl</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_dc_luminance_nrcodes</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">std_dc_luminance_values</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">UVDC_HT</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">computeHuffmanTbl</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_dc_chrominance_nrcodes</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">std_dc_chrominance_values</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">YAC_HT</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">computeHuffmanTbl</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_ac_luminance_nrcodes</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">std_ac_luminance_values</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">UVAC_HT</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">computeHuffmanTbl</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_ac_chrominance_nrcodes</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">std_ac_chrominance_values</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bitcode</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>65535<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">category</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>65535<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initCategoryNumber</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nrlower</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nrupper</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 2;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bitString</span>:<span class="ActionScriptDefault_Text">BitString</span>;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I15</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 15;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pos</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cat</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>1; <span class="ActionScriptDefault_Text">cat</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">I15</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">cat</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//Positive numbers
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nr</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">nrlower</span>; <span class="ActionScriptDefault_Text">nr</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">nrupper</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">nr</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">pos</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span>32767<span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">nr</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">category</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cat</span>;
                    <span class="ActionScriptDefault_Text">bitcode</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bitString</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">bitString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cat</span>;
                    <span class="ActionScriptDefault_Text">bitString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nr</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptComment">//Negative numbers
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nrneg</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nrupper</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptDefault_Text">nrneg</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">nrlower</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">nrneg</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">pos</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span>32767<span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">nrneg</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">category</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cat</span>;
                    <span class="ActionScriptDefault_Text">bitcode</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bitString</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">bitString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cat</span>;
                    <span class="ActionScriptDefault_Text">bitString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nrupper</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">nrneg</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">nrlower</span> <span class="ActionScriptOperator">&lt;&lt;=</span> 1;
                <span class="ActionScriptDefault_Text">nrupper</span> <span class="ActionScriptOperator">&lt;&lt;=</span> 1;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// IO functions
</span>        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">byteout</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bytenew</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bytepos</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 7;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bs</span>:<span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">val</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">posval</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">len</span><span class="ActionScriptOperator">-</span>1;
            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">posval</span> <span class="ActionScriptOperator">&gt;=</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">&lt;&lt;</span> <span class="ActionScriptDefault_Text">posval</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>                
                    <span class="ActionScriptDefault_Text">bytenew</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">&lt;&lt;</span> <span class="ActionScriptDefault_Text">bytepos</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">posval</span><span class="ActionScriptOperator">--</span>;
                <span class="ActionScriptDefault_Text">bytepos</span><span class="ActionScriptOperator">--</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bytepos</span> <span class="ActionScriptOperator">&lt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bytenew</span> <span class="ActionScriptOperator">==</span> 0xFF<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0xFF<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bytenew</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">bytepos</span><span class="ActionScriptOperator">=</span>7;
                    <span class="ActionScriptDefault_Text">bytenew</span><span class="ActionScriptOperator">=</span>0;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeWord</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptOperator">&gt;&gt;</span>8<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&amp;</span>0xFF<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>   <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&amp;</span>0xFF<span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// DCT &amp; quantization core
</span>        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fDCTQuant</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">data</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">/* Pass 1: process rows. */</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dataOff</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">d0</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">d1</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">d2</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">d3</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">d4</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">d5</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">d6</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">d7</span>:<span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I8</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 8;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I64</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 64;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I8</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>    
                <span class="ActionScriptDefault_Text">d0</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d5</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d6</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>6<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d7</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>7<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp0</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d0</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d7</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp7</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d0</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d7</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp1</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d1</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d6</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp6</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d1</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d6</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d5</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp5</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d5</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp3</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d3</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d4</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp4</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d3</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d4</span>;
                
                <span class="ActionScriptComment">/* Even part */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp10</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp0</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp3</span>;    <span class="ActionScriptComment">/* phase 2 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp13</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp0</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp3</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp11</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp1</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp2</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp12</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp1</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp2</span>;
                
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp10</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp11</span>; <span class="ActionScriptComment">/* phase 3 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp10</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp11</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z1</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tmp12</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp13</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> 0.707106781; <span class="ActionScriptComment">/* c4 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp13</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z1</span>; <span class="ActionScriptComment">/* phase 5 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>6<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp13</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z1</span>;
                
                <span class="ActionScriptComment">/* Odd part */</span>
                <span class="ActionScriptDefault_Text">tmp10</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp4</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp5</span>; <span class="ActionScriptComment">/* phase 2 */</span>
                <span class="ActionScriptDefault_Text">tmp11</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp5</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp6</span>;
                <span class="ActionScriptDefault_Text">tmp12</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp6</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp7</span>;
                
                <span class="ActionScriptComment">/* The rotator is modified from fig 4-8 to avoid extra negations. */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z5</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tmp10</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp12</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> 0.382683433; <span class="ActionScriptComment">/* c6 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0.541196100 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">tmp10</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z5</span>; <span class="ActionScriptComment">/* c2-c6 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z4</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1.306562965 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">tmp12</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z5</span>; <span class="ActionScriptComment">/* c2+c6 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z3</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp11</span> <span class="ActionScriptOperator">*</span> 0.707106781; <span class="ActionScriptComment">/* c4 */</span>
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z11</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp7</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z3</span>;    <span class="ActionScriptComment">/* phase 5 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z13</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp7</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z3</span>;
                
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z13</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z2</span>;    <span class="ActionScriptComment">/* phase 6 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z13</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z2</span>;
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z11</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z4</span>;
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>7<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z11</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z4</span>;
                
                <span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+=</span> 8; <span class="ActionScriptComment">/* advance pointer to next row */</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">/* Pass 2: process columns. */</span>
            <span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I8</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">d0</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+</span> 8<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+</span> 16<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d3</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+</span> 24<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d4</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+</span> 32<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d5</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+</span> 40<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d6</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+</span> 48<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">d7</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span> <span class="ActionScriptOperator">+</span> 56<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp0p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d0</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d7</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp7p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d0</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d7</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp1p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d1</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d6</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp6p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d1</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d6</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp2p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d5</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp5p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d5</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp3p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d3</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">d4</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp4p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d3</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">d4</span>;
                
                <span class="ActionScriptComment">/* Even part */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp10p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp0p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp3p2</span>;    <span class="ActionScriptComment">/* phase 2 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp13p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp0p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp3p2</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp11p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp1p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp2p2</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmp12p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp1p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp2p2</span>;
                
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp10p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp11p2</span>; <span class="ActionScriptComment">/* phase 3 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>32<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp10p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp11p2</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z1p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tmp12p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp13p2</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> 0.707106781; <span class="ActionScriptComment">/* c4 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>16<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp13p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z1p2</span>; <span class="ActionScriptComment">/* phase 5 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>48<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp13p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z1p2</span>;
                
                <span class="ActionScriptComment">/* Odd part */</span>
                <span class="ActionScriptDefault_Text">tmp10p2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp4p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp5p2</span>; <span class="ActionScriptComment">/* phase 2 */</span>
                <span class="ActionScriptDefault_Text">tmp11p2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp5p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp6p2</span>;
                <span class="ActionScriptDefault_Text">tmp12p2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp6p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tmp7p2</span>;
                
                <span class="ActionScriptComment">/* The rotator is modified from fig 4-8 to avoid extra negations. */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z5p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tmp10p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tmp12p2</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> 0.382683433; <span class="ActionScriptComment">/* c6 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z2p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0.541196100 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">tmp10p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z5p2</span>; <span class="ActionScriptComment">/* c2-c6 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z4p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1.306562965 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">tmp12p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z5p2</span>; <span class="ActionScriptComment">/* c2+c6 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z3p2</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp11p2</span> <span class="ActionScriptOperator">*</span> 0.707106781; <span class="ActionScriptComment">/* c4 */</span>
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z11p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp7p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z3p2</span>;    <span class="ActionScriptComment">/* phase 5 */</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z13p2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tmp7p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z3p2</span>;
                
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>40<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z13p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z2p2</span>; <span class="ActionScriptComment">/* phase 6 */</span>
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>24<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z13p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z2p2</span>;
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span> 8<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z11p2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z4p2</span>;
                <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">+</span>56<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z11p2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">z4p2</span>;
                
                <span class="ActionScriptDefault_Text">dataOff</span><span class="ActionScriptOperator">++</span>; <span class="ActionScriptComment">/* advance pointer to next column */</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Quantize/descale the coefficients
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fDCTQuant</span>:<span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I64</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Apply the quantization and scaling factor &amp; Round to nearest integer
</span>                <span class="ActionScriptDefault_Text">fDCTQuant</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fdtbl</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">outputfDCTQuant</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fDCTQuant</span> <span class="ActionScriptOperator">&gt;</span> 0.0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fDCTQuant</span> <span class="ActionScriptOperator">+</span> 0.5<span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fDCTQuant</span> <span class="ActionScriptOperator">-</span> 0.5<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">outputfDCTQuant</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Chunk writing
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeAPP0</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0xFFE0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// marker
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>16<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// length
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x4A<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// J
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x46<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// F
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x49<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// I
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x46<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// F
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// = "JFIF",'\0'
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// versionhi
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// versionlo
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// xyunits
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// xdensity
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// ydensity
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// thumbnwidth
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// thumbnheight
</span>        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeSOF0</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0xFFC0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// marker
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>17<span class="ActionScriptBracket/Brace">)</span>;   <span class="ActionScriptComment">// length, truecolor YUV JPG
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>8<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// precision
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>3<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// nrofcomponents
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// IdY
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x11<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HVY
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// QTY
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>2<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// IdU
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x11<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HVU
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// QTU
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>3<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// IdV
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x11<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HVV
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>;    <span class="ActionScriptComment">// QTV
</span>        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeDQT</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0xFFDB<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// marker
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>132<span class="ActionScriptBracket/Brace">)</span>;       <span class="ActionScriptComment">// length
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I64</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 64;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I64</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">YTable</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I64</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UVTable</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeDHT</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0xFFC4<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// marker
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0x01A2<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// length
</span>            
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HTYDCinfo
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I11</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 11;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I16</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 16;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I161</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 161;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I16</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_dc_luminance_nrcodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">I11</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_dc_luminance_values</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x10<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HTYACinfo
</span>            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I16</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_ac_luminance_nrcodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">I161</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_ac_luminance_values</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HTUDCinfo
</span>            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I16</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_dc_chrominance_nrcodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">I11</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_dc_chrominance_values</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x11<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HTUACinfo
</span>            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I16</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_ac_chrominance_nrcodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">I161</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">std_ac_chrominance_values</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeSOS</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0xFFDA<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// marker
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>12<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// length
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>3<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// nrofcomponents
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// IdY
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HTY
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>2<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// IdU
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x11<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HTU
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>3<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// IdV
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x11<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// HTV
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// Ss
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0x3f<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// Se
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeByte</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// Bf
</span>        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Core processing
</span>        <span class="ActionScriptReserved">internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DU</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">processDU</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">CDU</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">DC</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">HTDC</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">HTAC</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">EOB</span>:<span class="ActionScriptDefault_Text">BitString</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">HTAC</span><span class="ActionScriptBracket/Brace">[</span>0x00<span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">M16zeroes</span>:<span class="ActionScriptDefault_Text">BitString</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">HTAC</span><span class="ActionScriptBracket/Brace">[</span>0xF0<span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pos</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I16</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 16;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I63</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 63;
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">I64</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 64;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DU_DCT</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fDCTQuant</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">CDU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//ZigZag reorder
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">I64</span>;<span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">DU</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ZigZag</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">DU_DCT</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Diff</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">DU</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">DC</span>; <span class="ActionScriptDefault_Text">DC</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">DU</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptComment">//Encode DC
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Diff</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">HTDC</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// Diff might be 0
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">pos</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span>32767<span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Diff</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">HTDC</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">category</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bitcode</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">//Encode ACs
</span>            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">end0pos</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 63;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span>; <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">end0pos</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&amp;&amp;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DU</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">end0pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptDefault_Text">end0pos</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> {};
            <span class="ActionScriptComment">//end0pos = first element in reverse order !=0
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">end0pos</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">EOB</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">DC</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">end0pos</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">startpos</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span>; <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DU</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">end0pos</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span> {}
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nrzeroes</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">startpos</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nrzeroes</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">I16</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">lng</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nrzeroes</span><span class="ActionScriptOperator">&gt;&gt;</span>4;
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nrmarker</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>1; <span class="ActionScriptDefault_Text">nrmarker</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">lng</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">nrmarker</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">M16zeroes</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">nrzeroes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nrzeroes</span><span class="ActionScriptOperator">&amp;</span>0xF<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">pos</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span>32767<span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">DU</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">HTAC</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nrzeroes</span><span class="ActionScriptOperator">&lt;&lt;</span>4<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">category</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bitcode</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">end0pos</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">I63</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">EOB</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">DC</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">YDU</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">UDU</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">VDU</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span>64<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">/*
        private function RGB2YUV(img:BitmapData, xpos:int, ypos:int):void
        {
        var pos:int=0;
        const I8:int = 8;
        for (var y:int=0; y&lt;I8; ++y) {
        for (var x:int=0; x&lt;I8; ++x) {
        var P:uint = img.getPixel32(xpos+x,ypos+y);
        var R:int = (P&gt;&gt;16)&amp;0xFF;
        var G:int = (P&gt;&gt; 8)&amp;0xFF;
        var B:int = (P    )&amp;0xFF;
        YDU[int(pos)]=((( 0.29900)*R+( 0.58700)*G+( 0.11400)*B))-0x80;
        UDU[int(pos)]=(((-0.16874)*R+(-0.33126)*G+( 0.50000)*B));
        VDU[int(pos)]=((( 0.50000)*R+(-0.41869)*G+(-0.08131)*B));
        ++pos;
        }
        }
        }
        
        */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RGB2YUV</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xpos</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ypos</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pos</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">&lt;</span> 8; <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">&lt;</span> 8; <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xpos</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ypos</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">R</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">P</span><span class="ActionScriptOperator">&gt;&gt;</span>16<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&amp;</span>0xFF<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">G</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">P</span><span class="ActionScriptOperator">&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&amp;</span>0xFF<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">B</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">P</span>    <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&amp;</span>0xFF<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">YDU</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span> 0.29900<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">R</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span> 0.58700<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">G</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span> 0.11400<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">B</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">-</span>128;
                    <span class="ActionScriptDefault_Text">UDU</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span>0.16874<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">R</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span>0.33126<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">G</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span> 0.50000<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">B</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">VDU</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span> 0.50000<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">R</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span>0.41869<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">G</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span>0.08131<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">B</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">pos</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>        
        
        <span class="ActionScriptASDoc">/**
         * Returns an unmultiplied ARGB color value (that contains alpha channel
         * data and RGB data) as an unsigned integer.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">uint</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bitmap</span>:<span class="ActionScriptDefault_Text">BitmapData</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">BitmapData</span>;
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">bitmap</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">byteArray</span>:<span class="ActionScriptDefault_Text">ByteArray</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">ByteArray</span>;
                <span class="ActionScriptDefault_Text">byteArray</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> 4<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> 4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">byteArray</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">readUnsignedInt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArgumentError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"The source argument must be an instance of flash.display.BitmapData or flash.utils.ByteArray."</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">JPEGFasterAsyncEncoder</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">quality</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>50<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">quality</span> <span class="ActionScriptOperator">&lt;=</span> 0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">quality</span> <span class="ActionScriptOperator">=</span> 1;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">quality</span> <span class="ActionScriptOperator">&gt;</span> 100<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">quality</span> <span class="ActionScriptOperator">=</span> 100;
            
            <span class="ActionScriptDefault_Text">sf</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">quality</span> <span class="ActionScriptOperator">&lt;</span> 50 <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span>5000 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">quality</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span>200 <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">quality</span><span class="ActionScriptOperator">&lt;&lt;</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">init</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">init</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">ZigZag</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">aasf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">YQT</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">UVQT</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_ac_chrominance_nrcodes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_ac_chrominance_values</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_ac_luminance_nrcodes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_ac_luminance_values</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_dc_chrominance_nrcodes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_dc_chrominance_values</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_dc_luminance_nrcodes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">std_dc_luminance_values</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fixed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptComment">// Create tables
</span>            <span class="ActionScriptDefault_Text">initHuffmanTbl</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">initCategoryNumber</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">initQuantTables</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sf</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DCY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DCU</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DCV</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SrcWidth</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SrcHeight</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Source</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">TotalSize</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">PixelsPerIter</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 128;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">PercentageInc</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">NextProgressAt</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">CurrentTotalPos</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Working</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">contentType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">CONTENT_TYPE</span>; <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">PixelsPerIteration</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
        <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">PixelsPerIter</span>; <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">PixelsPerIteration</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">PixelsPerIter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">val</span>; <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">ImageData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ByteArray</span>
        <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">byteout</span>; <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">encodeByteArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">raw</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">internalEncode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">raw</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">encode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">internalEncode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptBracket/Brace">}</span>
        
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">internalEncode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newSource</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Working</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptDefault_Text">Working</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">Source</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newSource</span>;
            <span class="ActionScriptDefault_Text">SrcWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">width</span>;
            <span class="ActionScriptDefault_Text">SrcHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">height</span>;
            <span class="ActionScriptDefault_Text">TotalSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">height</span>;
            <span class="ActionScriptDefault_Text">PercentageInc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">TotalSize</span><span class="ActionScriptOperator">/</span>100;
            <span class="ActionScriptDefault_Text">NextProgressAt</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">PercentageInc</span>;
            <span class="ActionScriptDefault_Text">CurrentTotalPos</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptDefault_Text">setTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">StartEncode</span><span class="ActionScriptOperator">,</span> 10<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">StartEncode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Initialize bit writer
</span>            <span class="ActionScriptDefault_Text">byteout</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">bytenew</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">bytepos</span> <span class="ActionScriptOperator">=</span> 7;
            
            <span class="ActionScriptComment">// Add JPEG headers
</span>            <span class="ActionScriptDefault_Text">writeWord</span><span class="ActionScriptBracket/Brace">(</span>0xFFD8<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// SOI
</span>            <span class="ActionScriptDefault_Text">writeAPP0</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeDQT</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeSOF0</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SrcWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">SrcHeight</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeDHT</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeSOS</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">DCY</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">DCV</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">DCU</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptDefault_Text">bytenew</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">bytepos</span> <span class="ActionScriptOperator">=</span> 7;
            
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PROGRESS</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">TotalSize</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">setTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">AsyncLoop</span><span class="ActionScriptOperator">,</span> 10<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>     
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">AsyncLoop</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xpos</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ypos</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">PixelsPerIter</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span> 
                <span class="ActionScriptDefault_Text">RGB2YUV</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Source</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xpos</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ypos</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">SrcWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">SrcHeight</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">DCY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">processDU</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">YDU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl_Y</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">DCY</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">YDC_HT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">YAC_HT</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">DCU</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">processDU</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UDU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl_UV</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">DCU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVDC_HT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVAC_HT</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">DCV</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">processDU</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">VDU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl_UV</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">DCV</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVDC_HT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVAC_HT</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xpos</span> <span class="ActionScriptOperator">+=</span> 8;       
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xpos</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">SrcWidth</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">xpos</span> <span class="ActionScriptOperator">=</span> 0;
                    <span class="ActionScriptDefault_Text">ypos</span> <span class="ActionScriptOperator">+=</span> 8;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ypos</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">SrcHeight</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">setTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FinishEncode</span><span class="ActionScriptOperator">,</span> 10<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">CurrentTotalPos</span> <span class="ActionScriptOperator">+=</span> 64;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">CurrentTotalPos</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">NextProgressAt</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PROGRESS</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">CurrentTotalPos</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">TotalSize</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">NextProgressAt</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">PercentageInc</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">setTimeout</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">AsyncLoop</span><span class="ActionScriptOperator">,</span> 10<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xpos</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ypos</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">FinishEncode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//EOI
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bytepos</span> <span class="ActionScriptOperator">&gt;=</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fillbits</span>:<span class="ActionScriptDefault_Text">BitString</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">fillbits</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bytepos</span> <span class="ActionScriptOperator">+</span> 1;
                <span class="ActionScriptDefault_Text">fillbits</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">&lt;&lt;</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bytepos</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> 1;
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fillbits</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">writeWord</span><span class="ActionScriptBracket/Brace">(</span>0xFFD9<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PROGRESS</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">TotalSize</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">TotalSize</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">JPEGAsyncCompleteEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">Working</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">encode2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ByteArray</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Initialize bit writer
</span>            <span class="ActionScriptDefault_Text">byteout</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">bytenew</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptDefault_Text">bytepos</span><span class="ActionScriptOperator">=</span>7;
            
            <span class="ActionScriptComment">// Add JPEG headers
</span>            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0xFFD8<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// SOI
</span>            <span class="ActionScriptDefault_Text">writeAPP0</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeDQT</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeSOF0</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeDHT</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeSOS</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Encode 8x8 macroblocks
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DCY</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DCU</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DCV</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptDefault_Text">bytenew</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptDefault_Text">bytepos</span><span class="ActionScriptOperator">=</span>7;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ypos</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">ypos</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">height</span>; <span class="ActionScriptDefault_Text">ypos</span><span class="ActionScriptOperator">+=</span>8<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xpos</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">xpos</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">width</span>; <span class="ActionScriptDefault_Text">xpos</span><span class="ActionScriptOperator">+=</span>8<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">RGB2YUV</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xpos</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ypos</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">DCY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">processDU</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">YDU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl_Y</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">DCY</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">YDC_HT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">YAC_HT</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">DCU</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">processDU</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UDU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl_UV</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">DCU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVDC_HT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVAC_HT</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">DCV</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">processDU</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">VDU</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fdtbl_UV</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">DCV</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVDC_HT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">UVAC_HT</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Do the bit alignment of the EOI marker
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">bytepos</span> <span class="ActionScriptOperator">&gt;=</span> 0 <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fillbits</span>:<span class="ActionScriptDefault_Text">BitString</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">fillbits</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">len</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bytepos</span><span class="ActionScriptOperator">+</span>1;
                <span class="ActionScriptDefault_Text">fillbits</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptOperator">&lt;&lt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bytepos</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">-</span>1;
                <span class="ActionScriptDefault_Text">writeBits</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fillbits</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">byteout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeShort</span><span class="ActionScriptBracket/Brace">(</span>0xFFD9<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//EOI
</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">byteout</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptReserved">final</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">BitString</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">len</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">val</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
